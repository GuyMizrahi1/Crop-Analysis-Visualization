<div dir="rtl">

# פרויקט ויזואליזציה: ניתוח מצב החנקן בגידולים חקלאיים
## Information Visualization Project: Crop Nitrogen Status Analysis

**מגיש:** גיא מזרחי
**קורס:** ויזואליזציה של מידע
**תאריך:** ינואר 2026

---

## 1. תיאור הנתונים (Data Description)

### 1.1 מקור הנתונים
הנתונים נאספו במסגרת מחקר לתזה לתואר שני העוסק בזיהוי מצב החנקן בצמחים באמצעות ספקטרוסקופיה. המחקר בוצע בשיתוף מכון וולקני ומשרד החקלאות.

### 1.2 סוגי הגידולים
הנתונים כוללים 4 סוגי גידולים:
- **הדרים (Citrus)** - הגידול המרכזי בניסוי NPK
- **שקדים (Almond)** - גידול עצי פרי
- **אבוקדו (Avocado)** - גידול טרופי
- **גפן (Vine)** - גידול ליין

### 1.3 מיקומי איסוף הדגימות
הדגימות נאספו מ-4 תחנות מחקר ברחבי ישראל:

| מיקום                   | אזור | קואורדינטות | תיאור |
|-------------------------|------|-------------|-------|
| גילת (Gilat)            | נגב | 31.34°N, 34.65°E | תחנת המחקר המרכזית - ניסוי NPK |
| קדמה (Kedma)            | מרכז | 31.62°N, 34.78°E | אזור חקלאי במרכז הארץ |
| כברי (Kabri)            | גליל מערבי | 33.02°N, 35.13°E | אקלים צפוני |
| כפר מנחם (Kfar Menahem) | מישור החוף | 31.73°N, 34.83°E | אקלים ים-תיכוני |

### 1.4 תהליך איסוף ועיבוד הנתונים

```
איסוף עלים ← ייבוש ← טחינה ← מדידה במכשיר Element (NIR) ← עיבוד וניתוח
```

1. **איסוף עלים:** דגימות עלים נאספו מעצים שונים בתחנות המחקר
2. **ייבוש:** העלים יובשו בטמפרטורה מבוקרת
3. **טחינה:** העלים הטחונים הוכנסו למבחנות ומשם למכשיר ה-Element
4. **מדידת ספקטרום:** מכשיר ה-Element מודד ספקטרוסקופיית אינפרא-אדום קרוב (NIR)
5. **ניתוח כימי:** במקביל בוצע ניתוח כימי לקביעת ערכי N, ST, SC

### 1.5 מבנה הנתונים

**נתונים ספקטרליים:**
- 1,557 אורכי גל (wavelengths)
- טווח: 3,999-10,001 ננומטר (mid-IR/NIR)
- כל דגימה מכילה וקטור של 1,557 ערכים

**ערכים כימיים:**

| מדד | תיאור | יחידות | טווח טיפוסי |
|-----|-------|--------|-------------|
| N_Value | תכולת חנקן בעלה (LNC) | % | 2.0-4.0% |
| ST_Value | תכולת עמילן | mg/g | 30-220 mg/g |
| SC_Value | פחמימות מסיסות | mg/g | משתנה |

### 1.6 עיבוד וניקוי הנתונים
- **הסרת חריגים:** ערכים שליליים הוסרו מהנתונים
- **איחוד מקורות:** נתונים ממספר מקורות אוחדו לטבלה אחת
- **פורמט אחיד:** כל דגימה מזוהה ע"י ID הכולל: סוג גידול, תאריך, מיקום

### 1.7 ניסוי NPK
ניסוי מבוקר בתחנת גלעד על עצי הדרים:

| טיפול | כמות חנקן | מספרי עצים | תיאור |
|-------|-----------|-------------|-------|
| N10 | 10 kg N/ha | 3, 30, 42, 46, 63 | נמוך מאוד |
| N40 | 40 kg N/ha | 5, 19, 44, 49, 67 | נמוך |
| N60 | 60 kg N/ha | 12, 29, 43, 58, 61 | **אופטימלי** |
| N100 | 100 kg N/ha | 15, 18, 40, 47, 68 | עודף |
| N150 | 150 kg N/ha | 13, 24, 35, 57, 74 | עודף גבוה |

### 1.8 היקף הנתונים
- **סה"כ דגימות:** ~7,500 דגימות
- **תקופת איסוף:** 2021-2024
- **מימדים:** מעל 1,560 מימדים (1,557 ספקטרליים + 3 כימיים + מטא-דאטה)

---

## 2. עבודות קשורות (Related Works)

### 2.1 מחקרים בסיסיים

#### Paz-Kagan et al. (2020)
**"Assessing the nitrogen status of almond trees by visible-to-shortwave infrared reflectance spectroscopy of carbohydrates"**

*Computers and Electronics in Agriculture, 178*

- המחקר הדגים כיצד ספקטרוסקופיית VIS-SWIR יכולה לזהות מצב חנקן בשקדים
- נמצא קשר בין ספקטרום ההחזרה לבין תכולת הפחמימות והחנקן
- https://doi.org/10.1016/j.compag.2020.105755

#### Sperling et al. (2020)
**"Precise fertilization by a mass-balance of the seasonal changes in nutrient uptake by almond trees"**

*Agronomy, 10(9)*

- המחקר פיתח גישה לדישון מדויק על בסיס מאזן מסה עונתי
- הודגמה החשיבות של עיתוי הדישון בהתאם לשלב הפנולוגי
- https://doi.org/10.3390/agronomy10091277

### 2.2 הקשר לפרויקט הנוכחי
מחקרים אלו מהווים את הבסיס התיאורטי לפרויקט:
- שימוש בנתונים ספקטרליים לחיזוי ערכים כימיים
- הבנת הדינמיקה העונתית של חנקן ופחמימות
- יישום לחקלאות מדייקת (Precision Agriculture)

---

## 3. ניתוח תיאורטי - מודל WWH (What, Why, How)

### ויזואליזציה 1: סיפור איסוף הנתונים

| רכיב | תיאור |
|------|-------|
| **What** | התפלגות דגימות לפי זמן, עונה ומיקום גיאוגרפי |
| **Why** | להציג את היקף ומגוון הנתונים שנאספו |
| **How** | גרף עמודות לציר הזמן, גרף עמודות להתפלגות עונתית, מפת ישראל עם עיגולים בגודל יחסי למספר הדגימות |

**קידודים ויזואליים:**
- צבע = סוג גידול (כתום=הדרים, חום=שקדים, ירוק=אבוקדו, ורוד=גפן)
- גודל עיגול = מספר דגימות
- מיקום = קואורדינטות גיאוגרפיות

---

### ויזואליזציה 2: הצגת הספקטרום

| רכיב | תיאור                                                                                 |
|------|---------------------------------------------------------------------------------------|
| **What** | עקומות ספקטרליות (1,557 אורכי גל) וחלוקה לכל סוג גידול                                |
| **Why** | השוואה של "החותמת" הספקטרלית בין גידולים                                              |
| **How** | גרף עקומות עם מתג המאפשר 2 חלופות של הצגת כל הדגימות לעומת הממוצעים יחד עם סטיות התקן |

**קידודים ויזואליים:**
- ציר X = אורך גל (nm)
- ציר Y = ערך ספקטרלי
- צבע קו = סוג גידול
- שקיפות (בתצוגת דגימות) = מאפשרת לראות התפלגות

**אינטראקטיביות:**
- מתג בין תצוגות
- לחיצה על אגדה להסתרת/הצגת גידול

---

### ויזואליזציה 3: ניתוח ניסוי NPK

| רכיב | תיאור |
|------|-------|
| **What** | ערכי N ו-ST לפי 5 טיפולי דישון |
| **Why** | להשוות את השפעת רמות הדישון על ערכים כימיים |
| **How** | טבלת טיפולים, ציר זמן, גרפי פיזור ו-Box plots |

**קידודים ויזואליים:**
- צבע = טיפול (כחול→אדום לפי רמת N)
- מיקום = ערך כימי
- Box plot = התפלגות ערכים

---

### ויזואליזציה 4: ניתוח שונות העמילן

| רכיב | תיאור |
|------|-------|
| **What** | ערכי ST לאורך זמן ולפי שנה |
| **Why** | לחקור את השונות הגבוהה שנצפתה בערכי העמילן |
| **How** | Box plots חודשיים, גרף קווי לאורך זמן, Box plots לפי שנה |

**תגלית מרכזית:** אפקט השנה שולט על אפקט הטיפול!
- 2022: שנת דלדול עמילן (~50-80 mg/g)
- 2023: התאוששות (~120-160 mg/g)
- 2024: יציבות (~100-140 mg/g)

---

### ויזואליזציה 5: סיווג מצב LNC

| רכיב | תיאור |
|------|-------|
| **What** | ערכי חנקן בעלה מול ספי UC Davis |
| **Why** | לסווג מצב החנקן לפי סטנדרטים מקובלים |
| **How** | טבלת סיפים, גרף עם רצועות צבעוניות לכל קטגוריה |

**ספי UC Davis (אוקטובר, מותאמים לפי התנהגות חודשית של ההדרים):**

| קטגוריה | סף | משמעות |
|---------|-----|---------|
| עודף | >3.48% | להפחית דישון |
| גבוה | 3.24-3.48% | לנטר |
| אופטימלי | 2.88-3.24% | טווח אידיאלי |
| נמוך | 2.64-2.88% | לשקול דישון |
| חסר | <2.64% | דישון מיידי |

**התאמה עונתית - גורמי כפל חודשיים:**

| חודש | ינו׳ | פבר׳ | מרץ | אפר׳ | מאי | יוני | יולי | אוג׳ | ספט׳ | אוק׳ | נוב׳ | דצמ׳ |
|------|------|------|-----|------|-----|------|------|------|------|------|------|------|
| גורם | 1.125 | 1.080 | 1.010 | 0.950 | 0.910 | 0.920 | 0.940 | 0.960 | 0.980 | 1.000 | 1.040 | 1.125 |

---

### ויזואליזציה 6: ניתוח יחס N/ST

| רכיב | תיאור |
|------|-------|
| **What** | יחס N/ST מנורמל לאורך זמן |
| **Why** | להציע מדד טוב יותר לעיתוי דישון |
| **How** | גרפי קווים מנורמלים לתקופות שונות |

**הבעיה:** LNC לבדו מגיע לשיא בחורף (אפקט ריכוז) - לא בזמן שהצמח צריך דישון

**הפתרון:** יחס N/ST
- N עולה + ST יורד = יחס עולה = סימן לצורך בדישון
- מזהה נכון את תקופת אביב-קיץ כזמן האופטימלי לדישון

---

### 3.5 אינטראקטיביות (Interactive Features)

הפרויקט כולל מספר ויזואליזציות אינטראקטיביות המאפשרות למשתמש לחקור את הנתונים בצורה דינמית. דרישת הקורס הייתה לכלול לפחות 2 ויזואליזציות אינטראקטיביות - הפרויקט כולל 3:

#### ויזואליזציה 1.3 - מפת ישראל אינטראקטיבית
- **לחיצה על עיגול:** מציגה חלון מידע (popup) עם פירוט מספר הדגימות לפי סוג גידול
- **Hover:** מציג את שם המיקום וסך כל הדגימות במיקום זה
- **גודל העיגול:** יחסי למספר הדגימות הכולל באותו מיקום
- **יתרון:** מאפשר לחקור את הפיזור הגיאוגרפי והרכב הגידולים בכל תחנת מחקר

#### ויזואליזציה 2.1 - מתג תצוגה (Toggle Button)
- **כפתור "All Samples":** מציג את כל הדגימות הבודדות עם שקיפות גבוהה - מאפשר לראות את השונות הפנימית
- **כפתור "Mean ± SD":** מציג ממוצע וסטיית תקן לכל גידול - מאפשר השוואה נקייה בין גידולים
- **לחיצה על האגדה:** מאפשרת להסתיר/להציג גידולים ספציפיים לניתוח ממוקד
- **יתרון:** נותן למשתמש גמישות לבחור את רמת הפירוט המתאימה לניתוח

#### ויזואליזציה 3.2 - Ridgeline עם Centroids
- **לחיצה על Ridgeline:** מציגה את הצנטרואיד (מרכז הכובד) של הטיפול על גרף הפיזור
- **Toggle:** כל לחיצה מפעילה/מכבה את הצנטרואיד - ניתן להציג מספר צנטרואידים במקביל
- **יתרון:** מאפשר להבין היכן נמצא "מרכז" כל טיפול במרחב N-ST ולהשוות בין טיפולים

---

## 4. הסבר לבחירות הויזואליזציות

### 4.1 ויזואליזציה 1 - למה Timeline, התפלגות עונתית ומפה?

**גרף Timeline (1.1):**
- **בחירה:** גרף עמודות מקובצות (Grouped Bar Chart)
- **למה:** מציג את הכיסוי הזמני ומאפשר לזהות תקופות של איסוף אינטנסיבי
- **יתרון על Stacked Bar:** מאפשר השוואה ישירה בין גידולים באותו חודש

**התפלגות עונתית (1.2):**
- **בחירה:** גרף עמודות לפי Day-of-Year (DOY)
- **למה:** מאגד את כל השנים יחד לחשיפת דפוסים עונתיים
- **תובנה:** הדרים הם הגידול היחיד עם כיסוי מלא של 12 חודשים

**מפה (1.3):**
- **בחירה:** מפת Leaflet אינטראקטיבית עם עיגולים בגודל יחסי
- **למה:** מספק הקשר גיאוגרפי ומראה את הפיזור המרחבי של תחנות המחקר
- **אינטראקטיביות:** לחיצה חושפת פירוט לפי גידול

### 4.2 ויזואליזציה 2 - למה גרף קווי לספקטרום?

**בחירה:** גרף קווים (Line Chart) עם מתג בין תצוגות
- **למה קווים ולא נקודות:** הספקטרום הוא רציף - כל אורך גל קשור לשכניו
- **ממוצע ± SD:** מאפשר השוואה נקייה בין גידולים והבנת השונות
- **כל הדגימות:** מראה את השונות הפנימית בכל גידול - חושף outliers
- **מתג:** נותן גמישות למשתמש לבחור את רמת הפירוט המתאימה
- **שקיפות:** מאפשרת לראות התפלגות וחפיפה בין דגימות

### 4.3 ויזואליזציה 3 - למה Scatter + Ridgeline?

**גרף פיזור (Scatter Plot):**
- **למה:** מציג את הקשר הדו-מימדי בין N ל-ST
- **יתרון:** רואים את כל הדגימות במרחב אחד

**Ridgeline Plots:**
- **למה:** מציגים את ההתפלגות החד-מימדית של כל משתנה
- **יתרון על Boxplot רגיל:** חושפים צורת התפלגות (bimodality, skewness)
- **מיקום:** בציר העליון (N) ובציר הימני (ST) - מחוברים לגרף הפיזור

**Centroids אינטראקטיביים:**
- **למה:** מאפשרים לראות את "מרכז הכובד" של כל טיפול
- **יתרון:** מפשטים השוואה בין 5 טיפולים ללא עומס ויזואלי

### 4.4 ויזואליזציה 4 - למה Violin Plots וניתוח שנתי?

**Violin Plots (4.1):**
- **למה:** חושפים צורת התפלגות - זיהינו דפוסים bimodal בחודשים מסוימים
- **יתרון על Box Plot:** מראים את צפיפות הנתונים, לא רק quartiles
- **תגלית:** השונות לא מוסברת על ידי עונתיות בלבד

**ניתוח לפי שנה (4.2, 4.3):**
- **למה:** לאחר שראינו שונות גבוהה, חיפשנו הסבר
- **תגלית:** אפקט השנה שולט על אפקט הטיפול!
  - 2022: שנת דלדול עמילן (~50-80 mg/g)
  - 2023: התאוששות (~120-160 mg/g)
  - 2024: יציבות (~100-140 mg/g)

### 4.5 ויזואליזציה 5 - למה רצועות צבעוניות דינמיות?

**טבלת ספים דינמית (5.1):**
- **למה:** UC Davis נותן ספים לאוקטובר בלבד - התאמנו לכל חודש
- **גורמי כפל עונתיים:** מבוססים על דינמיקת החנקן בהדרים

**רצועות צבעוניות (5.2):**
- **למה:** מאפשרות לראות מיד באיזו קטגוריה נמצאת כל דגימה
- **גרדיאנט ירוק:** מפחית עומס קוגניטיבי (לא צבעים שונים לחלוטין)
- **רצועות דינמיות:** עוקבות אחרי גורמי הכפל החודשיים - לא קווים ישרים
- **תובנה:** N60, N100, N150 כולם נשארים ברצועה האופטימלית

### 4.6 ויזואליזציה 6 - למה נרמול ויחס N/ST?

**הבעיה עם LNC לבדו:**
- LNC מגיע לשיא בחורף (אפקט ריכוז - פחות מים בעלה)
- זה לא הזמן שהצמח צריך דישון!

**הפתרון - יחס N/ST:**
- **למה יחס:** N עולה + ST יורד = יחס עולה = סימן לצורך בדישון
- **למה נרמול:** מאפשר השוואה בין טיפולים במונחים יחסיים (0-1)
- **יתרון:** מדגיש את הדפוס העונתי המשותף ומזהה את שיאי הדישון

**חלונות עונתיים:**
- **חורף (כחול):** N גבוה, ST נמוך - תנוחה
- **אביב (זהב):** שיא ראשון - פריחה ויצירת פרי
- **קיץ (כתום):** שיא שני - גדילת פרי

---

## 5. צילומי מסך (Snapshots)

### ויזואליזציה 1: סיפור איסוף הנתונים
![ויזואליזציה 1 - סיפור איסוף הנתונים](../visualization_1_data_collection/screenshot.png)

### ויזואליזציה 2: הצגת הספקטרום
![ויזואליזציה 2 - הצגת הספקטרום](../visualization_2_spectral_explorer/screenshot.png)

### ויזואליזציה 3: ניתוח ניסוי NPK
![ויזואליזציה 3 - ניתוח ניסוי NPK](../visualization_3_npk_experiment/screenshot.png)

### ויזואליזציה 4: ניתוח שונות העמילן
![ויזואליזציה 4 - ניתוח שונות העמילן](../visualization_4_st_variance/screenshot.png)

### ויזואליזציה 5: סיווג מצב LNC
![ויזואליזציה 5 - סיווג מצב LNC](../visualization_5_lnc_classification/screenshot.png)

### ויזואליזציה 6: ניתוח יחס N/ST
![ויזואליזציה 6 - ניתוח יחס N/ST](../visualization_6_nst_ratio_analysis/screenshot.png)

---

## 6. קוד (Code)

**קישור ל-GitHub:**
https://github.com/GuyMizrahi1/Crop-Analysis-Visualization.git

**מבנה הקוד:**
```
Crop-Analysis-Visualization/
├── shared/config.py              # הגדרות משותפות
├── visualization_1_data_collection/
├── visualization_2_spectral_explorer/
├── visualization_3_npk_experiment/
├── visualization_4_st_variance/
├── visualization_5_lnc_classification/
└── visualization_6_nst_ratio_analysis/
```

**טכנולוגיות:**
- Python 3.9+
- Plotly (גרפים אינטראקטיביים)
- Pandas (עיבוד נתונים)
- Leaflet.js (מפות)

---

## סיכום

פרויקט זה מציג 6 ויזואליזציות המספרות את סיפור המחקר:

1. **איסוף נתונים** ← היקף ומגוון הנתונים
2. **ספקטרום** ← ההבדלים הביוכימיים בין גידולים
3. **ניסוי NPK** ← השפעת רמות דישון
4. **שונות ST** ← גילוי אפקט השנה
5. **סיווג LNC** ← יישום סטנדרטים מקובלים
6. **יחס N/ST** ← הצעת פתרון לעיתוי דישון מדויק

**התובנה המרכזית:** יחס N/ST עדיף על LNC לבדו לקביעת עיתוי דישון אופטימלי.

</div>
